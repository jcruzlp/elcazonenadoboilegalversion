{% extends 'base.html.twig' %}

{% block title %}Profiles{% endblock %}

{% block body %}
<div class="profiles-page">
  <h1>Profiles</h1>
  <p class="subtitle">Estado de conocimientos por perfil</p>

  <div class="actions">
    <a href="{{ path('app_profile_new') }}" class="cta-button">➕ Nuevo Perfil</a>
    <a href="{{ path('app_skill_new') }}" class="cta-button">➕ Nueva Skill</a>
  </div>

  {% for profile in profiles %}
    <div class="profile-card">
      <h2>{{ profile.name }}</h2>

      <div class="profile-actions">
        <a href="{{ path('app_profile_edit', {id: profile.id}) }}" class="btn-edit">✏️ Editar Perfil</a>
        <form method="post" action="{{ path('app_profile_delete', {id: profile.id}) }}" class="inline-form"
              onsubmit="return confirm('¿Seguro que quieres eliminar este perfil?');">
          <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ profile.id) }}">
          <button class="btn-delete">🗑 Eliminar Perfil</button>
        </form>
      </div>

      <table class="skills-table">
        <thead>
          <tr>
            <th>Skill</th>
            <th>Junior</th>
            <th>Senior</th>
            <th>Expert</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          {% for skill in profile.skills %}
            <tr>
              <td>{{ skill.name }}</td>
              <td>{{ skill.junior }}%</td>
              <td>{{ skill.senior }}%</td>
              <td>{{ skill.expert }}%</td>
              <td class="skill-actions">
                <a href="{{ path('app_skill_edit', {id: skill.id}) }}" class="btn-edit">✏️ Editar</a>
                <form method="post" action="{{ path('app_skill_delete', {id: skill.id}) }}" class="inline-form"
                      onsubmit="return confirm('¿Seguro que quieres eliminar esta skill?');">
                  <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ skill.id) }}">
                  <button class="btn-delete">🗑 Eliminar</button>
                </form>
              </td>
            </tr>
          {% else %}
            <tr><td colspan="5">No hay skills para este perfil</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% else %}
    <p>No hay perfiles cargados.</p>
  {% endfor %}
</div>
{% endblock %}
